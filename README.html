<!doctype html>
<html>
<head>
<meta charset="utf-8">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/default.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">
<link rel="stylesheet" href="file:////home/tuco/.vscode-server/extensions/goessner.mdmath-2.7.4/themes/default/style.css">

</head>
<body class="markdown-body">
<div  ></div>
<div style="padding: 2% 5%;">
<div  ></div>
<h1 style="text-align: center;">
<div style="color:grey; font-size: 0.6em;">Jakub Ostrzołek</div>
<div>WSI ćwiczenie 4 - drzewo ID3</div>
</h1>
<h2 id="opis-%C4%87wiczenia">Opis ćwiczenia</h2>
<p>Celem ćwiczenia było zaimplementowanie drzewa decyzyjnego ID3.</p>
<p>Klasa implementująca drzewo ma jeden parametr konstruktora:</p>
<ul>
<li><code>max_depth</code> - maksymalna wysokość drzewa powstałego w wyniku uczenia się.</li>
</ul>
<p>Klasa ta ma 2 główne funkcje (zgodne z biblioteką sklearn):</p>
<ul>
<li><code>fit</code> - uczenie drzewa na podstawie danych wejściowych i przypisanych im klas wyjściowych,</li>
<li><code>predict</code> - przewidywanie klas dla danych wejściowych (wcześniej nauczonych przez <code>fit</code>).</li>
</ul>
<h2 id="wykorzystane-zewn%C4%99trzne-biblioteki">Wykorzystane zewnętrzne biblioteki</h2>
<ul>
<li><code>numpy</code></li>
<li><code>pandas</code></li>
<li><code>matplotlib</code></li>
<li><code>sklearn</code></li>
</ul>
<h2 id="trenowanie-drzewa">Trenowanie drzewa</h2>
<p>Aby wytrenować drzewo należy wykonać skrypt <code>main.py</code> i postępować zgodnie z instrukcjami (<code>main.py --help</code>).<br>
Skrypt wygeneruje nowe drzewo, wytrenuje je na podstawie danych ze zbioru danych <em>iris</em>, oraz pokaże osiągi drzewa w postaci wybranych metryk i macierzy konfuzji na wykresie.</p>
<h2 id="wykresy">Wykresy</h2>
<p>Aby wygenerować wykresy, należy wykonać skrypt <code>plot.py</code>. Za pomocą skryptu można wygenerować:</p>
<ul>
<li>macierze konfuzji dla wybranych zbiorów danych</li>
<li>porównanie metryk dla wybranych zbiorów danych</li>
<li>powyższe wykresy dla najlepszej kombinacji hiperparametrów (pod względem sumy metryk)</li>
</ul>
<p>Każdy wykres jest opisany dwoma hiperparametrami:</p>
<ul>
<li><code>depth</code> - maksymalna głębokość drzewa</li>
<li><code>n_bins</code> - &quot;rozdzielczość&quot; dyskretyzacji danych wejściowych (dane wejściowe są grupowane w klasy tak, by w każdej klasie była porównywalna ilość rekordów)</li>
</ul>
<p>Oto przykładowe wyniki:</p>
<ul>
<li><code>n_bins = 5</code> - różne maksymalne głębokości drzewa</li>
</ul>
<p><img src="plots/b=5&amp;d=0.jpg" alt="wykres" class="loading" id="image-hash--1231091816" data-src="plots/b=5&amp;d=0.jpg">
<img src="plots/b=5&amp;d=1.jpg" alt="wykres" class="loading" id="image-hash--1230168295" data-src="plots/b=5&amp;d=1.jpg">
<img src="plots/b=5&amp;d=2.jpg" alt="wykres" class="loading" id="image-hash--1229244774" data-src="plots/b=5&amp;d=2.jpg">
<img src="plots/b=5&amp;d=3.jpg" alt="wykres" class="loading" id="image-hash--1228321253" data-src="plots/b=5&amp;d=3.jpg">
<img src="plots/b=5&amp;d=4.jpg" alt="wykres" class="loading" id="image-hash--1227397732" data-src="plots/b=5&amp;d=4.jpg"></p>
<ul>
<li><code>depth = 5</code> - różne &quot;rozdzielczości&quot; dyskretyzacji danych</li>
</ul>
<p><img src="plots/b=2&amp;d=4.jpg" alt="wykres" class="loading" id="image-hash--100001639" data-src="plots/b=2&amp;d=4.jpg">
<img src="plots/b=3&amp;d=4.jpg" alt="wykres" class="loading" id="image-hash--1907456102" data-src="plots/b=3&amp;d=4.jpg">
<img src="plots/b=5&amp;d=4.jpg" alt="wykres" class="loading" id="image-hash--1227397732" data-src="plots/b=5&amp;d=4.jpg">
<img src="plots/b=7&amp;d=4.jpg" alt="wykres" class="loading" id="image-hash--547339362" data-src="plots/b=7&amp;d=4.jpg"></p>
<h2 id="wnioski">Wnioski</h2>
<ul>
<li>Drzewo o maksymalnej głębokości 0 po prostu wybiera najczęściej występującą klasę w zbiorze trenującym. Jak można się spodziewać nie daje to zadowalających rezultatów.</li>
<li>W tym przypadku nie widać zjawiska przeuczenia drzewa dla większych głębokości. Może to być związane z niewielkim wymiarem danych wejściowych (testowanie większych głębokości niż 4 nie ma sensu, bo i tak nie ma wystarczająco parametrów w zbiorze danych wejściowych).</li>
<li>Natomiast widać zjawisko przeuczenia i niedouczenia dla skrajnych &quot;rozdzielczości&quot; dyskretyzacji danych. Z wykresów widać, że dla <code>n_bins = 5</code> (lub czasami 3, zależy od rozlosowania zbiorów) występują najlepsze metryki, a dla mniejszych i większych wartości tego parametru metryki stają się gorsze.</li>
</ul>
<p>Wyniki na zbiorze testowym dla drzewa o najlepszych hiperparametrach (dla zbiorów walidacyjnych):</p>
<p><img src="plots/test-best.jpg" alt="wykres" class="loading" id="image-hash--1805197876" data-src="plots/test-best.jpg"></p>
<div  ></div>
</div>
</body>
</html>